{"version":3,"file":"CL1279BtQ3lNGdmUN70n.js","sources":["../../src/stores/UserStore.ts"],"sourcesContent":["import {\n\tGatewayUserUpdateDispatchData,\n\tRoutes,\n\ttype APIUser,\n\ttype Snowflake,\n} from \"@spacebarchat/spacebar-api-types/v9\";\nimport { ObservableMap, action, computed, observable } from \"mobx\";\nimport useLogger from \"../hooks/useLogger\";\nimport AppStore from \"./AppStore\";\nimport User from \"./objects/User\";\n\nexport default class UserStore {\n\tprivate readonly logger = useLogger(\"UserStore\");\n\t@observable readonly users = new ObservableMap<string, User>();\n\n\tconstructor(private readonly app: AppStore) {}\n\n\t@action\n\tadd(user: APIUser): User {\n\t\tconst newUser = new User(user);\n\t\tthis.users.set(user.id, newUser);\n\t\treturn newUser;\n\t}\n\n\t@action\n\taddAll(users: APIUser[]) {\n\t\tusers.forEach((user) => this.add(user));\n\t}\n\n\t@action\n\tupdate(user: APIUser | GatewayUserUpdateDispatchData) {\n\t\tthis.users.get(user.id)?.update(user);\n\t}\n\n\t@action\n\tget(id: string) {\n\t\treturn this.users.get(id);\n\t}\n\n\t@computed\n\tget all() {\n\t\treturn Array.from(this.users.values());\n\t}\n\n\t@computed\n\tget count() {\n\t\treturn this.users.size;\n\t}\n\n\thas(id: string) {\n\t\treturn this.users.has(id);\n\t}\n\n\t@action\n\tasync resolve(id: Snowflake, force: boolean = false): Promise<User | undefined> {\n\t\tif (this.has(id) && !force) return this.get(id);\n\t\tconst user = await this.app.rest.get<APIUser>(Routes.user(id));\n\t\tif (!user) return undefined;\n\t\treturn this.add(user);\n\t}\n}\n"],"names":["UserStore","app","__publicField","useLogger","ObservableMap","user","newUser","User","users","_a","id","force","Routes","__decorateClass","observable","action","computed"],"mappings":"+gBAWA,MAAqBA,CAAU,CAI9B,YAA6BC,EAAe,CAH3BC,EAAA,cAASC,EAAU,WAAW,GAC1BD,EAAA,aAAQ,IAAIE,GAEJ,KAAA,IAAAH,CAAA,CAG7B,IAAII,EAAqB,CAClB,MAAAC,EAAU,IAAIC,EAAKF,CAAI,EAC7B,YAAK,MAAM,IAAIA,EAAK,GAAIC,CAAO,EACxBA,CAAA,CAIR,OAAOE,EAAkB,CACxBA,EAAM,QAASH,GAAS,KAAK,IAAIA,CAAI,CAAC,CAAA,CAIvC,OAAOA,EAA+C,QACrDI,EAAA,KAAK,MAAM,IAAIJ,EAAK,EAAE,IAAtB,MAAAI,EAAyB,OAAOJ,EAAI,CAIrC,IAAIK,EAAY,CACR,OAAA,KAAK,MAAM,IAAIA,CAAE,CAAA,CAIzB,IAAI,KAAM,CACT,OAAO,MAAM,KAAK,KAAK,MAAM,QAAQ,CAAA,CAItC,IAAI,OAAQ,CACX,OAAO,KAAK,MAAM,IAAA,CAGnB,IAAIA,EAAY,CACR,OAAA,KAAK,MAAM,IAAIA,CAAE,CAAA,CAIzB,MAAM,QAAQA,EAAeC,EAAiB,GAAkC,CAC3E,GAAA,KAAK,IAAID,CAAE,GAAK,CAACC,EAAO,OAAO,KAAK,IAAID,CAAE,EACxC,MAAAL,EAAO,MAAM,KAAK,IAAI,KAAK,IAAaO,EAAO,KAAKF,CAAE,CAAC,EACzD,GAACL,EACE,OAAA,KAAK,IAAIA,CAAI,CAAA,CAEtB,CA/CsBQ,EAAA,CAApBC,CAAA,EAFmBd,EAEC,UAAA,QAAA,CAAA,EAKrBa,EAAA,CADCE,CAAA,EANmBf,EAOpB,UAAA,MAAA,CAAA,EAOAa,EAAA,CADCE,CAAA,EAbmBf,EAcpB,UAAA,SAAA,CAAA,EAKAa,EAAA,CADCE,CAAA,EAlBmBf,EAmBpB,UAAA,SAAA,CAAA,EAKAa,EAAA,CADCE,CAAA,EAvBmBf,EAwBpB,UAAA,MAAA,CAAA,EAKIa,EAAA,CADHG,CAAA,EA5BmBhB,EA6BhB,UAAA,MAAA,CAAA,EAKAa,EAAA,CADHG,CAAA,EAjCmBhB,EAkChB,UAAA,QAAA,CAAA,EASEa,EAAA,CADLE,CAAA,EA1CmBf,EA2Cd,UAAA,UAAA,CAAA"}