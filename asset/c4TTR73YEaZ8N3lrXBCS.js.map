{"version":3,"file":"c4TTR73YEaZ8N3lrXBCS.js","sources":["../../src/stores/objects/QueuedMessage.ts"],"sourcesContent":["import { APIUser, MessageType } from \"@spacebarchat/spacebar-api-types/v9\";\nimport { action, makeObservable, observable } from \"mobx\";\nimport AppStore from \"../AppStore\";\nimport MessageBase from \"./MessageBase\";\n\nexport enum QueuedMessageStatus {\n\tSENDING = \"sending\",\n\tFAILED = \"failed\",\n}\n\nexport type QueuedMessageData = {\n\tid: string;\n\tchannel_id: string;\n\tguild_id?: string;\n\tcontent: string;\n\tfiles?: File[];\n\ttimestamp: string;\n\ttype: MessageType;\n\tauthor: APIUser;\n};\n\nexport default class QueuedMessage extends MessageBase {\n\tchannel_id: string;\n\tguild_id?: string;\n\tfiles?: File[];\n\t@observable progress = 0;\n\t@observable status: QueuedMessageStatus;\n\t@observable error?: string;\n\tabortCallback?: () => void;\n\n\tconstructor(app: AppStore, data: QueuedMessageData) {\n\t\tsuper(app, data);\n\t\tthis.id = data.id;\n\t\tthis.channel_id = data.channel_id;\n\t\tthis.guild_id = data.guild_id;\n\t\tthis.files = data.files;\n\t\tthis.status = QueuedMessageStatus.SENDING;\n\n\t\tmakeObservable(this);\n\t}\n\n\t@action\n\tupdateProgress(e: ProgressEvent) {\n\t\tthis.progress = Math.round((e.loaded / e.total) * 100);\n\t}\n\n\t@action\n\tsetAbortCallback(cb: () => void) {\n\t\tthis.abortCallback = cb;\n\t}\n\n\tabort() {\n\t\tif (this.abortCallback) {\n\t\t\tthis.abortCallback();\n\t\t}\n\t}\n\n\t@action\n\t/**\n\t * Mark this message as failed.\n\t */\n\tfail(error: string) {\n\t\tthis.error = error;\n\t\tthis.status = QueuedMessageStatus.FAILED;\n\t}\n\n\tdelete() {\n\t\t//\n\t}\n}\n"],"names":["QueuedMessageStatus","QueuedMessage","MessageBase","app","data","__publicField","makeObservable","e","cb","error","__decorateClass","observable","action"],"mappings":"idAKYA,GAAAA,IACXA,EAAA,QAAU,UACVA,EAAA,OAAS,SAFEA,IAAAA,GAAA,CAAA,CAAA,EAgBZ,MAAqBC,UAAsBC,CAAY,CAStD,YAAYC,EAAeC,EAAyB,CACnD,MAAMD,EAAKC,CAAI,EAThBC,EAAA,mBACAA,EAAA,iBACAA,EAAA,cACYA,EAAA,gBAAW,GACXA,EAAA,eACAA,EAAA,cACZA,EAAA,sBAIC,KAAK,GAAKD,EAAK,GACf,KAAK,WAAaA,EAAK,WACvB,KAAK,SAAWA,EAAK,SACrB,KAAK,MAAQA,EAAK,MAClB,KAAK,OAAS,UAEdE,EAAe,IAAI,CAAA,CAIpB,eAAeC,EAAkB,CAChC,KAAK,SAAW,KAAK,MAAOA,EAAE,OAASA,EAAE,MAAS,GAAG,CAAA,CAItD,iBAAiBC,EAAgB,CAChC,KAAK,cAAgBA,CAAA,CAGtB,OAAQ,CACH,KAAK,eACR,KAAK,cAAc,CACpB,CAOD,KAAKC,EAAe,CACnB,KAAK,MAAQA,EACb,KAAK,OAAS,QAAA,CAGf,QAAS,CAAA,CAGV,CA5CaC,EAAA,CAAXC,CAAA,EAJmBV,EAIR,UAAA,WAAA,CAAA,EACAS,EAAA,CAAXC,CAAA,EALmBV,EAKR,UAAA,SAAA,CAAA,EACAS,EAAA,CAAXC,CAAA,EANmBV,EAMR,UAAA,QAAA,CAAA,EAeZS,EAAA,CADCE,CAAA,EApBmBX,EAqBpB,UAAA,iBAAA,CAAA,EAKAS,EAAA,CADCE,CAAA,EAzBmBX,EA0BpB,UAAA,mBAAA,CAAA,EAcAS,EAAA,CAJCE,CAAA,EApCmBX,EAwCpB,UAAA,OAAA,CAAA"}