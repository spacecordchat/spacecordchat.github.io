{"version":3,"file":"CXdvWKsqGEKdGldw6Cpk.js","sources":["../../src/components/messaging/Message.tsx"],"sourcesContent":["import { observer } from \"mobx-react-lite\";\nimport { memo, useContext } from \"react\";\nimport { ContextMenuContext } from \"../../contexts/ContextMenuContext\";\nimport { useAppStore } from \"../../hooks/useAppStore\";\nimport { MessageLike } from \"../../stores/objects/Message\";\nimport { QueuedMessageStatus } from \"../../stores/objects/QueuedMessage\";\nimport Avatar from \"../Avatar\";\nimport Markdown from \"../markdown/MarkdownRenderer\";\nimport MessageAttachment from \"./MessageAttachment\";\nimport MessageAuthor from \"./MessageAuthor\";\nimport MessageBase, { MessageContent, MessageContentText, MessageDetails, MessageInfo } from \"./MessageBase\";\nimport MessageEmbed from \"./MessageEmbed\";\nimport AttachmentUploadProgress from \"./attachments/AttachmentUploadProgress\";\n\ninterface Props {\n\tmessage: MessageLike;\n\theader?: boolean;\n}\n\nfunction Message({ message, header }: Props) {\n\tconst app = useAppStore();\n\tconst contextMenuContext = useContext(ContextMenuContext);\n\n\tconst guild = message.guild_id ? app.guilds.get(message.guild_id) : undefined;\n\tconst isEveryoneMentioned = \"mention_everyone\" in message && message.mention_everyone;\n\tconst isUserMentioned = \"mentions\" in message && message.mentions.some((mention) => mention.id === app.account!.id);\n\tconst isRoleMentioned =\n\t\tguild &&\n\t\t\"mention_roles\" in message &&\n\t\tmessage.mention_roles.some((r1) => guild.members.me?.roles.some((r2) => r1 === r2.id));\n\n\treturn (\n\t\t<MessageBase\n\t\t\theader={header}\n\t\t\tmention={isEveryoneMentioned || isUserMentioned || isRoleMentioned}\n\t\t\tonContextMenu={(e) =>\n\t\t\t\tcontextMenuContext.onContextMenu(e, {\n\t\t\t\t\ttype: \"message\",\n\t\t\t\t\tmessage: message,\n\t\t\t\t})\n\t\t\t}\n\t\t>\n\t\t\t<MessageInfo>\n\t\t\t\t{header ? (\n\t\t\t\t\t<Avatar key={message.author.id} user={message.author} size={32} />\n\t\t\t\t) : (\n\t\t\t\t\t<MessageDetails message={message} position=\"left\" />\n\t\t\t\t)}\n\t\t\t</MessageInfo>\n\t\t\t<MessageContent>\n\t\t\t\t{header && (\n\t\t\t\t\t<span className=\"message-details\">\n\t\t\t\t\t\t<MessageAuthor message={message} guild={guild} />\n\t\t\t\t\t\t<MessageDetails message={message} position=\"top\" />\n\t\t\t\t\t</span>\n\t\t\t\t)}\n\n\t\t\t\t<MessageContentText\n\t\t\t\t\tsending={\"status\" in message && message.status === QueuedMessageStatus.SENDING}\n\t\t\t\t\tfailed={\"status\" in message && message.status === QueuedMessageStatus.FAILED}\n\t\t\t\t>\n\t\t\t\t\t{message.content && <Markdown content={message.content} />}\n\t\t\t\t</MessageContentText>\n\n\t\t\t\t{\"attachments\" in message &&\n\t\t\t\t\tmessage.attachments.map((attachment, index) => (\n\t\t\t\t\t\t<MessageAttachment key={index} attachment={attachment} />\n\t\t\t\t\t))}\n\t\t\t\t{\"embeds\" in message &&\n\t\t\t\t\tmessage.embeds?.map((embed, index) => <MessageEmbed key={index} embed={embed} />)}\n\t\t\t\t{\"files\" in message && message.files?.length !== 0 && <AttachmentUploadProgress message={message} />}\n\t\t\t</MessageContent>\n\t\t</MessageBase>\n\t);\n}\n\nexport default memo(observer(Message));\n"],"names":["Message","message","header","app","useAppStore","contextMenuContext","useContext","ContextMenuContext","guild","isEveryoneMentioned","isUserMentioned","mention","isRoleMentioned","r1","_a","r2","jsxs","MessageBase","e","jsx","MessageInfo","Avatar","MessageDetails","MessageContent","MessageAuthor","MessageContentText","QueuedMessageStatus","Markdown","attachment","index","MessageAttachment","embed","MessageEmbed","_b","AttachmentUploadProgress","Message$1","memo","observer"],"mappings":"0hBAmBA,SAASA,EAAQ,CAAE,QAAAC,EAAS,OAAAC,GAAiB,SAC5C,MAAMC,EAAMC,EAAY,EAClBC,EAAqBC,aAAWC,CAAkB,EAElDC,EAAQP,EAAQ,SAAWE,EAAI,OAAO,IAAIF,EAAQ,QAAQ,EAAI,OAC9DQ,EAAsB,qBAAsBR,GAAWA,EAAQ,iBAC/DS,EAAkB,aAAcT,GAAWA,EAAQ,SAAS,KAAMU,GAAYA,EAAQ,KAAOR,EAAI,QAAS,EAAE,EAC5GS,EACLJ,GACA,kBAAmBP,GACnBA,EAAQ,cAAc,KAAMY,GAAA,OAAO,OAAAC,EAAAN,EAAM,QAAQ,KAAd,YAAAM,EAAkB,MAAM,KAAMC,GAAOF,IAAOE,EAAG,IAAG,EAGrF,OAAAC,EAAA,KAACC,EAAA,CACA,OAAAf,EACA,QAASO,GAAuBC,GAAmBE,EACnD,cAAgBM,GACfb,EAAmB,cAAca,EAAG,CACnC,KAAM,UACN,QAAAjB,CAAA,CACA,EAGF,SAAA,CAAAkB,EAAAA,IAACC,GACC,SACAlB,EAAAiB,EAAAA,IAACE,GAA+B,KAAMpB,EAAQ,OAAQ,KAAM,EAAA,EAA/CA,EAAQ,OAAO,EAAoC,EAEhEkB,EAAA,IAACG,GAAe,QAAArB,EAAkB,SAAS,OAAO,CAEpD,CAAA,SACCsB,EACC,CAAA,SAAA,CACArB,GAAAc,EAAA,KAAC,OAAK,CAAA,UAAU,kBACf,SAAA,CAACG,EAAAA,IAAAK,EAAA,CAAc,QAAAvB,EAAkB,MAAAO,CAAc,CAAA,EAC9CW,EAAAA,IAAAG,EAAA,CAAe,QAAArB,EAAkB,SAAS,KAAM,CAAA,CAAA,EAClD,EAGDkB,EAAA,IAACM,EAAA,CACA,QAAS,WAAYxB,GAAWA,EAAQ,SAAWyB,EAAoB,QACvE,OAAQ,WAAYzB,GAAWA,EAAQ,SAAWyB,EAAoB,OAErE,WAAQ,SAAWP,EAAA,IAACQ,EAAS,CAAA,QAAS1B,EAAQ,OAAS,CAAA,CAAA,CACzD,EAEC,gBAAiBA,GACjBA,EAAQ,YAAY,IAAI,CAAC2B,EAAYC,IACnCV,EAAA,IAAAW,EAAA,CAA8B,WAAAF,CAAP,EAAAC,CAA+B,CACvD,EACD,WAAY5B,KACZa,EAAAb,EAAQ,SAAR,YAAAa,EAAgB,IAAI,CAACiB,EAAOF,IAAWV,EAAA,IAAAa,EAAA,CAAyB,MAAAD,CAAP,EAAAF,CAAqB,IAC9E,UAAW5B,KAAWgC,EAAAhC,EAAQ,QAAR,YAAAgC,EAAe,UAAW,GAAKd,EAAA,IAACe,GAAyB,QAAAjC,CAAkB,CAAA,CAAA,CACnG,CAAA,CAAA,CAAA,CACD,CAEF,CAEA,MAAAkC,EAAeC,OAAKC,EAASrC,CAAO,CAAC"}