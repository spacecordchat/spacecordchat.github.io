var O=Object.defineProperty;var f=(N,e,r)=>e in N?O(N,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):N[e]=r;var M=(N,e,r)=>f(N,typeof e!="symbol"?e+"":e,r);import"./DIBLJojdTQB51I2zM4gm.js";import{B as D,a as E}from"./gz-q3Aq5NNoBH1y1Fuxh.js";const A=class A extends D{constructor(r=0){super(r);M(this,"cache",{});this.bitfield&A.FLAGS.ADMINISTRATOR&&(this.bitfield=u)}any(r,t=!0){return t&&super.any(A.FLAGS.ADMINISTRATOR)||super.any(r)}has(r,t=!0){return t&&super.has(A.FLAGS.ADMINISTRATOR)||super.has(r)}overwriteChannel(r){if(!r)return this;if(!this.cache)throw new Error("permission chache not available");return r=r.filter(t=>{var i;return!!(t.type===0&&((i=this.cache.roles)!=null&&i.some(S=>S.id===t.id))||t.type===1&&t.id==this.cache.user_id)}),new A(A.channelPermission(r,this.bitfield))}static channelPermission(r,t){return r.reduce((i,S)=>i&~BigInt(S.deny)|BigInt(S.allow),t||BigInt(0))}static rolePermission(r){return r.reduce((t,i)=>t|BigInt(i.permissions),BigInt(0))}static finalPermission({user:r,guild:t,channel:i}){if(r.id==="0")return new A("ADMINISTRATOR");const S=t.roles.filter(o=>r.roles.includes(o.id));let s=A.rolePermission(S);if(i!=null&&i.overwrites){const o=i.overwrites.filter(I=>!!(I.type===0&&r.roles.includes(I.id)||I.type===1&&I.id==r.id));s=A.channelPermission(o,s)}return i!=null&&i.recipient_ids?(i==null?void 0:i.owner_id)===r.id?new A("ADMINISTRATOR"):i.recipient_ids.includes(r.id)?new A(["VIEW_CHANNEL","SEND_MESSAGES","STREAM","ADD_REACTIONS","EMBED_LINKS","ATTACH_FILES","READ_MESSAGE_HISTORY","MENTION_EVERYONE","USE_EXTERNAL_EMOJIS","CONNECT","SPEAK","MANAGE_CHANNELS"]):new A:new A(s)}static getPermission(r,t,i){var _;if(!r)throw new Error("User not found");let S;if(t){if((t==null?void 0:t.ownerId)===r)return new A(A.FLAGS.ADMINISTRATOR);S=t.members.get(r)}let s=(_=i==null?void 0:i.recipients)==null?void 0:_.map(T=>T.id);s!=null&&s.length||(s=void 0);const o=A.finalPermission({user:{id:r,roles:(S==null?void 0:S.roles.map(T=>T.id))||[]},guild:{roles:(S==null?void 0:S.roles)||[]},channel:{overwrites:i==null?void 0:i.permissionOverwrites,owner_id:i==null?void 0:i.ownerId,recipient_ids:s}}),I=new A(o);return I.cache={guild:t,member:S,channel:i,roles:S==null?void 0:S.roles,user_id:r},I}};M(A,"FLAGS",{CREATE_INSTANT_INVITE:E(0),KICK_MEMBERS:E(1),BAN_MEMBERS:E(2),ADMINISTRATOR:E(3),MANAGE_CHANNELS:E(4),MANAGE_GUILD:E(5),ADD_REACTIONS:E(6),VIEW_AUDIT_LOG:E(7),PRIORITY_SPEAKER:E(8),STREAM:E(9),VIEW_CHANNEL:E(10),SEND_MESSAGES:E(11),SEND_TTS_MESSAGES:E(12),MANAGE_MESSAGES:E(13),EMBED_LINKS:E(14),ATTACH_FILES:E(15),READ_MESSAGE_HISTORY:E(16),MENTION_EVERYONE:E(17),USE_EXTERNAL_EMOJIS:E(18),VIEW_GUILD_INSIGHTS:E(19),CONNECT:E(20),SPEAK:E(21),MUTE_MEMBERS:E(22),DEAFEN_MEMBERS:E(23),MOVE_MEMBERS:E(24),USE_VAD:E(25),CHANGE_NICKNAME:E(26),MANAGE_NICKNAMES:E(27),MANAGE_ROLES:E(28),MANAGE_WEBHOOKS:E(29),MANAGE_EMOJIS_AND_STICKERS:E(30),USE_APPLICATION_COMMANDS:E(31),REQUEST_TO_SPEAK:E(32),MANAGE_EVENTS:E(33),MANAGE_THREADS:E(34),USE_PUBLIC_THREADS:E(35),USE_PRIVATE_THREADS:E(36),USE_EXTERNAL_STICKERS:E(37)});let R=A;const u=Object.values(R.FLAGS).reduce((N,e)=>N|e,BigInt(0));export{R as P};
//# sourceMappingURL=BsHAe7mWCTqodyXnQ_D1.js.map
