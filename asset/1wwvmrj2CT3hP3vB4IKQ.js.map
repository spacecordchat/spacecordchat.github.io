{"version":3,"file":"1wwvmrj2CT3hP3vB4IKQ.js","sources":["../../src/components/Avatar.tsx"],"sourcesContent":["import { PresenceUpdateStatus } from \"@spacebarchat/spacebar-api-types/v9\";\nimport { observer } from \"mobx-react-lite\";\nimport React, { useRef } from \"react\";\nimport styled from \"styled-components\";\nimport { useAppStore } from \"../hooks/useAppStore\";\nimport AccountStore from \"../stores/AccountStore\";\nimport Presence from \"../stores/objects/Presence\";\nimport User from \"../stores/objects/User\";\nimport Container from \"./Container\";\n\nconst Wrapper = styled(Container)<{ size: number; hasClick?: boolean }>`\n\tbackground-color: transparent;\n\tdisplay: flex;\n\tflex-direction: column;\n\tuser-select: none;\n`;\n\ninterface Props {\n\tuser?: User | AccountStore;\n\tsize: 32 | 80;\n\tstyle?: React.CSSProperties;\n\tonClick?: React.MouseEventHandler<HTMLDivElement> | null;\n\tpopoutPlacement?: \"left\" | \"right\" | \"top\" | \"bottom\";\n\tpresence?: Presence;\n\tstatusDotStyle?: {\n\t\tsize?: number;\n\t\tborderThickness?: number;\n\t};\n\tshowPresence?: boolean;\n\tisFloating?: boolean;\n}\n\nfunction Avatar(props: Props) {\n\tconst app = useAppStore();\n\n\tconst ref = useRef<HTMLDivElement>(null);\n\n\tconst user = props.user ?? app.account;\n\tif (!user) return null;\n\n\tconst presenceRingsTreatment = app.experiments.getTreatment(\"presence_rings\");\n\tconst ringsEnabled = presenceRingsTreatment && presenceRingsTreatment.id === 2;\n\n\tconst children = (\n\t\t<Wrapper size={props.size} style={props.style} ref={ref} hasClick={props.onClick !== null}>\n\t\t\t{props.showPresence && props.presence ? (\n\t\t\t\t!ringsEnabled ? (\n\t\t\t\t\t<div\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tposition: \"relative\",\n\t\t\t\t\t\t\tdisplay: \"inline-block\",\n\t\t\t\t\t\t\twidth: props.size,\n\t\t\t\t\t\t\theight: props.size,\n\t\t\t\t\t\t}}\n\t\t\t\t\t>\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tborderRadius: \"50%\",\n\t\t\t\t\t\t\t\twidth: props.size,\n\t\t\t\t\t\t\t\theight: props.size,\n\t\t\t\t\t\t\t\tobjectFit: \"cover\",\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tsrc={user.avatarUrl}\n\t\t\t\t\t\t\tloading=\"eager\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tposition: \"absolute\",\n\t\t\t\t\t\t\t\twidth: props.statusDotStyle?.size ?? 14,\n\t\t\t\t\t\t\t\theight: props.statusDotStyle?.size ?? 14,\n\t\t\t\t\t\t\t\tbackgroundColor: app.theme.getStatusColor(\n\t\t\t\t\t\t\t\t\tprops.presence?.status ?? PresenceUpdateStatus.Offline,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tborderRadius: \"50%\",\n\t\t\t\t\t\t\t\tbottom: 0,\n\t\t\t\t\t\t\t\tright: 0,\n\t\t\t\t\t\t\t\tborder: `${\n\t\t\t\t\t\t\t\t\tprops.statusDotStyle?.borderThickness ?? 0.2\n\t\t\t\t\t\t\t\t}rem solid var(--background-secondary)`,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<img\n\t\t\t\t\t\twidth={props.size}\n\t\t\t\t\t\theight={props.size}\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tborderRadius: \"50%\",\n\t\t\t\t\t\t\tpointerEvents: \"none\",\n\t\t\t\t\t\t\tborder: `0.2rem solid ${app.theme.getStatusColor(\n\t\t\t\t\t\t\t\tprops.presence?.status ?? PresenceUpdateStatus.Offline,\n\t\t\t\t\t\t\t)}`,\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tsrc={user.avatarUrl}\n\t\t\t\t\t\tloading=\"eager\"\n\t\t\t\t\t/>\n\t\t\t\t)\n\t\t\t) : (\n\t\t\t\t<img\n\t\t\t\t\twidth={props.size}\n\t\t\t\t\theight={props.size}\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tborderRadius: \"50%\",\n\t\t\t\t\t\tpointerEvents: \"none\",\n\t\t\t\t\t}}\n\t\t\t\t\tsrc={user.avatarUrl}\n\t\t\t\t\tloading=\"eager\"\n\t\t\t\t/>\n\t\t\t)}\n\t\t</Wrapper>\n\t);\n\n\treturn children;\n}\n\nexport default observer(Avatar);\n"],"names":["Wrapper","styled","Container","Avatar","props","app","useAppStore","ref","useRef","user","presenceRingsTreatment","ringsEnabled","jsx","_e","PresenceUpdateStatus","jsxs","_a","_b","_c","_d","Avatar$1","observer"],"mappings":"sKAUA,MAAMA,EAAUC,EAAOC,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA,EAsBhC,SAASC,EAAOC,EAAc,eAC7B,MAAMC,EAAMC,EAAY,EAElBC,EAAMC,SAAuB,IAAI,EAEjCC,EAAOL,EAAM,MAAQC,EAAI,QAC3B,GAAA,CAACI,EAAa,OAAA,KAElB,MAAMC,EAAyBL,EAAI,YAAY,aAAa,gBAAgB,EACtEM,EAAeD,GAA0BA,EAAuB,KAAO,EAuEtE,OApELE,MAAAZ,EAAA,CAAQ,KAAMI,EAAM,KAAM,MAAOA,EAAM,MAAO,IAAAG,EAAU,SAAUH,EAAM,UAAY,KACnF,SAAAA,EAAM,cAAgBA,EAAM,SAC3BO,EAqCAC,EAAA,IAAC,MAAA,CACA,MAAOR,EAAM,KACb,OAAQA,EAAM,KACd,MAAO,CACN,aAAc,MACd,cAAe,OACf,OAAQ,gBAAgBC,EAAI,MAAM,iBACjCQ,EAAAT,EAAM,WAAN,YAAAS,EAAgB,SAAUC,EAAqB,OAAA,CAC/C,EACF,EACA,IAAKL,EAAK,UACV,QAAQ,OAAA,CAAA,EA/CTM,EAAA,KAAC,MAAA,CACA,MAAO,CACN,SAAU,WACV,QAAS,eACT,MAAOX,EAAM,KACb,OAAQA,EAAM,IACf,EAEA,SAAA,CAAAQ,EAAA,IAAC,MAAA,CACA,MAAO,CACN,aAAc,MACd,MAAOR,EAAM,KACb,OAAQA,EAAM,KACd,UAAW,OACZ,EACA,IAAKK,EAAK,UACV,QAAQ,OAAA,CACT,EACAG,EAAA,IAAC,MAAA,CACA,MAAO,CACN,SAAU,WACV,QAAOI,EAAAZ,EAAM,iBAAN,YAAAY,EAAsB,OAAQ,GACrC,SAAQC,EAAAb,EAAM,iBAAN,YAAAa,EAAsB,OAAQ,GACtC,gBAAiBZ,EAAI,MAAM,iBAC1Ba,EAAAd,EAAM,WAAN,YAAAc,EAAgB,SAAUJ,EAAqB,OAChD,EACA,aAAc,MACd,OAAQ,EACR,MAAO,EACP,OAAQ,KACPK,EAAAf,EAAM,iBAAN,YAAAe,EAAsB,kBAAmB,EAC1C,uCAAA,CACD,CAAA,CACA,CAAA,CAAA,EAkBHP,EAAA,IAAC,MAAA,CACA,MAAOR,EAAM,KACb,OAAQA,EAAM,KACd,MAAO,CACN,aAAc,MACd,cAAe,MAChB,EACA,IAAKK,EAAK,UACV,QAAQ,OAAA,CAAA,EAGX,CAIF,CAEA,MAAeW,EAAAC,EAASlB,CAAM"}