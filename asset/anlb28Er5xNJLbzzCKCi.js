var l=Object.defineProperty;var c=(r,e,s)=>e in r?l(r,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[e]=s;var g=(r,e,s)=>c(r,typeof e!="symbol"?e+"":e,s);import{ai as u,ag as f,a0 as v,aj as n,ak as d}from"./DIBLJojdTQB51I2zM4gm.js";import{u as y}from"./DMCex30FeWvvThtDj-pY.js";import{M as h}from"./Bksk8po2mr1aK-z4I8xj.js";var M=Object.defineProperty,T=Object.getOwnPropertyDescriptor,p=(r,e,s,a)=>{for(var t=a>1?void 0:a?T(e,s):e,o=r.length-1,i;o>=0;o--)(i=r[o])&&(t=(a?i(e,s,t):i(t))||t);return a&&t&&M(e,s,t),t};class m{constructor(e,s){g(this,"app");g(this,"channelId");g(this,"logger");g(this,"messages");this.app=e,this.channelId=s,this.logger=y("MessageStore.ts"),this.messages=u.array([]),f(this)}add(e){this.messages.push(new h(this.app,e))}addAll(e){e.forEach(s=>this.add(s))}get(e){return this.messages.find(s=>s.id===e)}has(e){return this.messages.some(s=>s.id===e)}remove(e){const s=this.get(e);s&&this.messages.remove(s)}update(e){const s=this.get(e.id);if(!s)return;const a=new h(this.app,e);this.messages[this.messages.indexOf(s)]=a}get count(){return this.messages.length}get groups(){return[...this.messages,...Array.from(this.app.queue.messages.values()).filter(a=>a.channel_id===this.channelId)].slice().sort((a,t)=>t.timestamp.getTime()-a.timestamp.getTime()).slice().sort((a,t)=>a.timestamp.getTime()-t.timestamp.getTime()).reduce((a,t)=>{const o=a[a.length-1],i=o==null?void 0:o.messages[o.messages.length-1];return i&&i.author.id===t.author.id&&i.type===t.type&&t.type===v.Default&&t.timestamp.getTime()-i.timestamp.getTime()<=10*60*1e3?o.messages.unshift(t):a.push({author:t.author,messages:[t]}),a},[]).reverse()}}p([u],m.prototype,"messages",2);p([n],m.prototype,"add",1);p([n],m.prototype,"addAll",1);p([n],m.prototype,"remove",1);p([n],m.prototype,"update",1);p([d],m.prototype,"count",1);p([d],m.prototype,"groups",1);export{m as M};
//# sourceMappingURL=anlb28Er5xNJLbzzCKCi.js.map
