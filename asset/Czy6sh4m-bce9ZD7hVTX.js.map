{"version":3,"file":"Czy6sh4m-bce9ZD7hVTX.js","sources":["../../src/components/messaging/MessageEmbed.tsx"],"sourcesContent":["// adapted from Revite\n// https://github.com/revoltchat/revite/blob/master/src/components/common/messaging/embed/Embed.tsx\n\nimport { APIEmbed, EmbedType } from \"@spacebarchat/spacebar-api-types/v9\";\nimport classNames from \"classnames\";\nimport React from \"react\";\nimport { decimalColorToHex } from \"../../utils/Utils\";\nimport Markdown from \"../markdown/Markdown\";\nimport MarkdownRenderer from \"../markdown/MarkdownRenderer\";\nimport styles from \"./Embed.module.css\";\nimport EmbedMedia from \"./EmbedMedia\";\nimport { MessageAreaWidthContext } from \"./MessageList\";\n\nconst LINK_EMBED_MAX_WIDTH = 516;\nconst RICH_EMBED_MAX_WIDTH = 428;\nconst CONTAINER_PADDING = 24;\nconst EMBEDDABLE_PROVIDERS = [\"Spotify\" /*, \"Bandcamp\"*/];\n\ninterface Props {\n\tembed: APIEmbed;\n}\n\nfunction MessageEmbed({ embed }: Props) {\n\tconst c = React.useContext(MessageAreaWidthContext);\n\t// const maxWidth = Math.min(c - MESSAGE_AREA_PADDING, MAX_EMBED_WIDTH);\n\n\t// function calculateSize(w: number, h: number): { width: number; height: number } {\n\t// \tconst limitingWidth = Math.min(w, maxWidth);\n\t// \tconst limitingHeight = Math.min(MAX_EMBED_HEIGHT, h);\n\n\t// \t// Calculate smallest possible WxH.\n\t// \tconst width = Math.min(limitingWidth, limitingHeight * (w / h));\n\n\t// \tconst height = Math.min(limitingHeight, limitingWidth * (h / w));\n\n\t// \treturn { width, height };\n\t// }\n\n\t// Determine special embed size.\n\tlet mw, mh;\n\tconst largeMedia =\n\t\tembed.provider?.name === \"GitHub\" ||\n\t\tembed.provider?.name === \"Streamable\" ||\n\t\tembed.type === EmbedType.Video ||\n\t\tembed.type === EmbedType.GIFV ||\n\t\tembed.type === EmbedType.Image;\n\n\t// const { width, height } = calculateSize(mw, mh);\n\tif (\n\t\tembed.type === EmbedType.GIFV ||\n\t\tembed.type === EmbedType.Image ||\n\t\t(embed.type === EmbedType.Video && embed.provider?.name !== \"YouTube\") ||\n\t\tEMBEDDABLE_PROVIDERS.includes(embed.provider?.name ?? \"\")\n\t) {\n\t\treturn <EmbedMedia embed={embed} />;\n\t}\n\n\treturn (\n\t\t<div\n\t\t\tclassName={classNames(styles.embed, styles.website)}\n\t\t\tstyle={{\n\t\t\t\tborderInlineStartColor: embed.color ? decimalColorToHex(embed.color) : \"var(--background-tertiary)\",\n\t\t\t\tmaxWidth: 432,\n\t\t\t}}\n\t\t>\n\t\t\t<div\n\t\t\t\tclassName={styles.embedGap}\n\t\t\t\tstyle={{\n\t\t\t\t\tmaxWidth: embed.type === EmbedType.Rich ? RICH_EMBED_MAX_WIDTH : LINK_EMBED_MAX_WIDTH,\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div style={{ display: \"flex\" }}>\n\t\t\t\t\t<div className={styles.embedGap}>\n\t\t\t\t\t\t{embed.type !== EmbedType.Rich && embed.provider && (\n\t\t\t\t\t\t\t<span className={styles.embedProvider}>{embed.provider.name}</span>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{embed.author && (\n\t\t\t\t\t\t\t<div className={styles.embedAuthor}>\n\t\t\t\t\t\t\t\t{embed.author.icon_url && (\n\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t\t\t\t\t\t\tclassName={styles.embedAuthorIcon}\n\t\t\t\t\t\t\t\t\t\tsrc={embed.author.icon_url}\n\t\t\t\t\t\t\t\t\t\tdraggable={false}\n\t\t\t\t\t\t\t\t\t\t// onError={(e) => (e.currentTarget.style.display = \"none\")}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t{embed.author.url ? (\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\thref={embed.url}\n\t\t\t\t\t\t\t\t\t\ttarget={\"_blank\"}\n\t\t\t\t\t\t\t\t\t\tclassName={classNames(styles.embedAuthorName, styles.embedAuthorNameLink)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{embed.author.name}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<span className={styles.embedAuthorName}>{embed.author.name}</span>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{embed.title && (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{embed.url ? (\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\thref={embed.url}\n\t\t\t\t\t\t\t\t\t\ttarget={\"_blank\"}\n\t\t\t\t\t\t\t\t\t\tclassName={classNames(styles.embedTitle, styles.embedTitleLink)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{embed.title}\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t<span className={styles.embedTitle}>{embed.title}</span>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{embed.description && (\n\t\t\t\t\t\t\t<div className={styles.embedDescription}>\n\t\t\t\t\t\t\t\t<MarkdownRenderer content={embed.description} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{embed.fields && (\n\t\t\t\t\t\t\t<div className={styles.embedFields}>\n\t\t\t\t\t\t\t\t{embed.fields.map((field, i) => (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t\tclassName={styles.embedField}\n\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t// inline = 1/7 for first, 7/14 for second\n\t\t\t\t\t\t\t\t\t\t\t// non-inline = 1/14\n\t\t\t\t\t\t\t\t\t\t\tgridColumn: field.inline ? (i % 2 === 0 ? \"1 / 7\" : \"7 / 13\") : \"1 / 13\",\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div className={styles.embedFieldName}>{field.name}</div>\n\t\t\t\t\t\t\t\t\t\t<div className={styles.embedFieldValue}>\n\t\t\t\t\t\t\t\t\t\t\t<Markdown content={field.value} />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{(!largeMedia || embed.type === EmbedType.Rich) && embed.thumbnail && (\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<EmbedMedia embed={embed} width={80} thumbnail />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t{(largeMedia || embed.type === EmbedType.Rich) && (\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<EmbedMedia embed={embed} width={embed.provider?.name === \"YouTube\" ? 400 : undefined} />\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\n\t\t\t\t{embed.footer && (\n\t\t\t\t\t<div className={styles.embedFooter}>\n\t\t\t\t\t\t{embed.footer.icon_url && (\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t\t\t\t\tclassName={styles.embedFooterIcon}\n\t\t\t\t\t\t\t\tsrc={embed.footer.icon_url}\n\t\t\t\t\t\t\t\tdraggable={false}\n\t\t\t\t\t\t\t\t// onError={(e) => (e.currentTarget.style.display = \"none\")}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<span className={styles.embedFooterText}>\n\t\t\t\t\t\t\t{embed.footer.text}\n\t\t\t\t\t\t\t{embed.timestamp && (\n\t\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t\t<span className={styles.embedFooterSeperator}>â€¢</span>\n\t\t\t\t\t\t\t\t\t{new Date(embed.timestamp).toLocaleString(undefined)}\n\t\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nexport default MessageEmbed;\n"],"names":["LINK_EMBED_MAX_WIDTH","RICH_EMBED_MAX_WIDTH","EMBEDDABLE_PROVIDERS","MessageEmbed","embed","React","MessageAreaWidthContext","largeMedia","_a","_b","EmbedType","_c","_d","jsx","EmbedMedia","classNames","styles","decimalColorToHex","jsxs","Fragment","MarkdownRenderer","field","i","Markdown","_e"],"mappings":"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"}