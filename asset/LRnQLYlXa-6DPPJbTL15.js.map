{"version":3,"file":"LRnQLYlXa-6DPPJbTL15.js","sources":["../../src/components/messaging/Chat.tsx"],"sourcesContent":["import { runInAction } from \"mobx\";\nimport { observer } from \"mobx-react-lite\";\nimport React, { useEffect } from \"react\";\nimport styled from \"styled-components\";\nimport { useAppStore } from \"../../hooks/useAppStore\";\nimport useLogger from \"../../hooks/useLogger\";\nimport Channel from \"../../stores/objects/Channel\";\nimport Guild from \"../../stores/objects/Guild\";\nimport MemberList from \"../MemberList/MemberList\";\nimport ChatHeader from \"./ChatHeader\";\nimport MessageInput from \"./MessageInput\";\nimport MessageList from \"./MessageList\";\nimport TypingIndicator from \"./TypingIndicator\";\n\n/**\n * Wrapps chat and member list into a row\n */\nconst WrapperOne = styled.div`\n\tdisplay: flex;\n\tflex-direction: row;\n\tflex: 1 1 auto;\n\toverflow: hidden;\n`;\n\n/**\n * Wraps the message list, header, and input into a column\n */\nconst WrapperTwo = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tbackground-color: var(--background-primary-alt);\n\tflex: 1 1 auto;\n\toverflow: hidden;\n`;\n\nconst Container = styled.div`\n\tdisplay: flex;\n\tflex-direction: column;\n\tflex: 1 1 auto;\n\tposition: relative;\n\toverflow: hidden;\n`;\n\ninterface Props {\n\tchannel?: Channel;\n\tguild?: Guild;\n\tchannelId?: string;\n\tguildId?: string;\n}\n\ninterface Props2 {\n\tchannel: Channel;\n\tguild: Guild;\n}\n\nfunction ChatContent({ channel, guild }: Props2) {\n\tconst app = useAppStore();\n\tconst readstate = app.readStateStore.get(channel.id);\n\n\tuseEffect(() => {\n\t\tchannel.markAsRead();\n\t}, [channel, guild]);\n\n\treturn (\n\t\t<Container>\n\t\t\t<MessageList guild={guild} channel={channel} before={readstate?.lastMessageId} />\n\t\t\t<MessageInput channel={channel} guild={guild} />\n\t\t\t<TypingIndicator channel={channel} />\n\t\t</Container>\n\t);\n}\n\nconst Content = observer((props: Props2) => {\n\tconst { memberListVisible } = useAppStore();\n\n\treturn (\n\t\t<WrapperOne>\n\t\t\t<ChatContent {...props} />\n\t\t\t{memberListVisible && <MemberList />}\n\t\t</WrapperOne>\n\t);\n});\n\n/**\n * Main component for rendering channel messages\n */\nfunction Chat() {\n\tconst app = useAppStore();\n\tconst logger = useLogger(\"Messages\");\n\tconst { activeChannel, activeGuild, activeChannelId, activeGuildId } = app;\n\n\tReact.useEffect(() => {\n\t\tif (!activeChannel || !activeGuild || activeChannelId === \"@me\") return;\n\n\t\trunInAction(() => {\n\t\t\tapp.gateway.onChannelOpen(activeGuildId!, activeChannelId!);\n\t\t});\n\t}, [activeChannel, activeGuild]);\n\n\tif (activeGuildId && activeGuildId === \"@me\") {\n\t\treturn (\n\t\t\t<WrapperTwo>\n\t\t\t\t<span\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tpadding: \"1rem\",\n\t\t\t\t\t\tuserSelect: \"none\",\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tHome Section Placeholder\n\t\t\t\t</span>\n\t\t\t</WrapperTwo>\n\t\t);\n\t}\n\n\tif (!activeGuild || !activeChannel) {\n\t\treturn (\n\t\t\t<WrapperTwo>\n\t\t\t\t<span\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\tcolor: \"var(--text-secondary)\",\n\t\t\t\t\t\tfontSize: \"1.5rem\",\n\t\t\t\t\t\tmargin: \"auto\",\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tUnknown Guild or Channel\n\t\t\t\t</span>\n\t\t\t</WrapperTwo>\n\t\t);\n\t}\n\n\treturn (\n\t\t<WrapperTwo>\n\t\t\t<ChatHeader channel={activeChannel} />\n\t\t\t<Content channel={activeChannel} guild={activeGuild} />\n\t\t</WrapperTwo>\n\t);\n}\n\nexport default observer(Chat);\n"],"names":["WrapperOne","styled","WrapperTwo","Container","ChatContent","channel","guild","readstate","useAppStore","useEffect","jsx","MessageList","MessageInput","TypingIndicator","Content","observer","props","memberListVisible","MemberList","Chat","app","activeChannel","activeGuild","activeChannelId","activeGuildId","React","runInAction","ChatHeader","Chat$1"],"mappings":"qWAiBA,MAAMA,EAAaC,EAAO;AAAA;AAAA;AAAA;AAAA;AAAA,EAUpBC,EAAaD,EAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAQpBE,EAAYF,EAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAoBzB,SAASG,EAAY,CAAE,QAAAC,EAAS,MAAAC,GAAiB,CAEhD,MAAMC,EADMC,EAAY,EACF,eAAe,IAAIH,EAAQ,EAAE,EAEnDI,OAAAA,EAAAA,UAAU,IAAM,CACfJ,EAAQ,WAAW,CAAA,EACjB,CAACA,EAASC,CAAK,CAAC,SAGjBH,EACA,CAAA,SAAA,CAAAO,EAAA,IAACC,EAAY,CAAA,MAAAL,EAAc,QAAAD,EAAkB,OAAQE,GAAA,YAAAA,EAAW,cAAe,EAC/EG,EAAAA,IAACE,EAAa,CAAA,QAAAP,EAAkB,MAAAC,CAAc,CAAA,EAC9CI,MAACG,GAAgB,QAAAR,CAAkB,CAAA,CAAA,EACpC,CAEF,CAEA,MAAMS,EAAUC,EAAUC,GAAkB,CACrC,KAAA,CAAE,kBAAAC,CAAkB,EAAIT,EAAY,EAE1C,cACER,EACA,CAAA,SAAA,CAACU,EAAAA,IAAAN,EAAA,CAAa,GAAGY,EAAO,EACvBC,SAAsBC,EAAW,CAAA,CAAA,CAAA,EACnC,CAEF,CAAC,EAKD,SAASC,GAAO,CACf,MAAMC,EAAMZ,EAAY,EAElB,CAAE,cAAAa,EAAe,YAAAC,EAAa,gBAAAC,EAAiB,cAAAC,CAAkB,EAAAJ,EAUnE,OARJK,EAAM,UAAU,IAAM,CACjB,CAACJ,GAAiB,CAACC,GAAeC,IAAoB,OAE1DG,EAAY,IAAM,CACbN,EAAA,QAAQ,cAAcI,EAAgBD,CAAgB,CAAA,CAC1D,CAAA,EACC,CAACF,EAAeC,CAAW,CAAC,EAE3BE,GAAiBA,IAAkB,YAEpCtB,EACA,CAAA,SAAAQ,EAAA,IAAC,OAAA,CACA,MAAO,CACN,QAAS,OACT,WAAY,MACb,EACA,SAAA,0BAAA,CAAA,EAGF,EAIE,CAACY,GAAe,CAACD,QAElBnB,EACA,CAAA,SAAAQ,EAAA,IAAC,OAAA,CACA,MAAO,CACN,MAAO,wBACP,SAAU,SACV,OAAQ,MACT,EACA,SAAA,0BAAA,CAAA,EAGF,SAKAR,EACA,CAAA,SAAA,CAACQ,EAAAA,IAAAiB,EAAA,CAAW,QAASN,CAAe,CAAA,EACnCX,EAAA,IAAAI,EAAA,CAAQ,QAASO,EAAe,MAAOC,CAAa,CAAA,CAAA,EACtD,CAEF,CAEA,MAAeM,EAAAb,EAASI,CAAI"}